<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 配置Mabatis映射文件 -->
<mapper namespace="com.mapper.ThinginfoMapper">
    <resultMap type="com.entity.Thinginfo" id="thinginfoMap">
        <id property="thinginfoid" column="thinginfoid"/>
        <result column="status" property="status" jdbcType="INTEGER"/>
        <result column="countrequire" property="countrequire" jdbcType="INTEGER"/>
        <result column="thingprice" property="thingprice" jdbcType="INTEGER"/>
        <result column="thinginfoname" property="thinginfoname" jdbcType="LONGVARCHAR"/>
        <result column="image" property="image" jdbcType="LONGVARCHAR"/>
        <result column="remark" property="remark" jdbcType="LONGVARCHAR"/>
        <result column="createdate" property="createdate" jdbcType="LONGVARCHAR"/>
        <result column="classifyinfoid" property="classifyinfoid" jdbcType="LONGVARCHAR"/>
    </resultMap>
    <!-- 插入语句 Mapper通过id调用此配置 -->
    <insert id="insert" parameterType="thinginfo">
		insert into thinginfo (thinginfoid, status, countrequire,
    thingprice, thinginfoname, image,
    remark, createdate, classifyinfoid
    )
    values (#{thinginfoid,jdbcType=INTEGER}, #{status,jdbcType=INTEGER}, #{countrequire,jdbcType=INTEGER},
    #{thingprice,jdbcType=INTEGER}, #{thinginfoname,jdbcType=LONGVARCHAR}, #{image,jdbcType=LONGVARCHAR},
    #{remark,jdbcType=LONGVARCHAR}, #{createdate,jdbcType=LONGVARCHAR}, #{classifyinfoid,jdbcType=LONGVARCHAR}
    )
	</insert>
    <!-- 更新语句 Mapper通过id调用此配置 -->
    <update id="update" parameterType="thinginfo">
		update thinginfo
        set
        status = #{status,jdbcType=INTEGER},
        countrequire = #{countrequire,jdbcType=INTEGER},
        thingprice = #{thingprice,jdbcType=INTEGER},
        thinginfoname = #{thinginfoname,jdbcType=LONGVARCHAR},
        image = #{image,jdbcType=LONGVARCHAR},
        remark = #{remark,jdbcType=LONGVARCHAR},
        createdate = #{createdate,jdbcType=LONGVARCHAR},
        classifyinfoid = #{classifyinfoid,jdbcType=LONGVARCHAR}
        where thinginfoid=#{thinginfoid}
	</update>
    <!-- 按主键删除 Mapper通过id调用此配置 -->
    <delete id="delete" parameterType="String">
		delete from thinginfo where thinginfoid = #{thinginfoid}
	</delete>
    <!-- 查询全部信息 Mapper通过id调用此配置 -->
    <select id="getAll" parameterType="map" resultMap="thinginfoMap">
        select
        thinginfo.*,
        classifyinfo.title as classifyinfotitle
        from thinginfo
        left join classifyinfo on classifyinfo.classifyinfoid=thinginfo.classifyinfoid
        where 1=1
        <if test="keyword != null and keyword != ''">
            and
            (
            thinginfoname like CONCAT('%',#{keyword},'%') or
            remark like CONCAT('%',#{keyword},'%')
            )
        </if>
        <if test="thingprice != null and thingprice != ''   or 0 == thingprice">
            and
            thinginfo.thingprice =#{thingprice}
        </if>
        <if test="classifyinfoid != null and classifyinfoid != ''   or 0 == classifyinfoid">
            and
            thinginfo.classifyinfoid =#{classifyinfoid}
        </if>
        order by thinginfoid desc
        <if test="(start != null and start != '') or start==0 ">
            <if test=" limit != null and limit != ''">
                limit #{start},#{limit}
            </if>
        </if>
    </select>

    <!-- 统计 获取 总数    用于分页-->
    <select id="getRowSize" parameterType="map" resultType="int" useCache="false">
        SELECT count(1)
        FROM thinginfo
        left join classifyinfo on classifyinfo.classifyinfoid=thinginfo.classifyinfoid

        where 1=1
        <if test="thingprice != null and thingprice != ''   or 0 == thingprice">
            and
            thinginfo.thingprice =#{thingprice}
        </if>
        <if test="classifyinfoid != null and classifyinfoid != ''    or 0 == classifyinfoid">
            and
            thinginfo.classifyinfoid =#{classifyinfoid}
        </if>
        <if test="keyword != null and keyword != ''">
            and
            (
            thinginfoname like CONCAT('%',#{keyword},'%') or
            remark like CONCAT('%',#{keyword},'%')
            )
        </if>

    </select>


    <!-- 按主键查询 Mapper通过id调用此配置 -->
    <select id="getById" parameterType="String" resultMap="thinginfoMap">
		select thinginfo.*,
        classifyinfo.title as classifyinfotitle from thinginfo
        left join classifyinfo on classifyinfo.classifyinfoid=thinginfo.classifyinfoid
          where thinginfoid=#{thinginfoid}
	</select>


    <!-- 按条件精确查询 Mapper通过id调用此配置 -->
    <select id="getByCond" parameterType="thinginfo" resultMap="thinginfoMap">
        select a.* from thinginfo a where 1=1
        <if test="username != null and '' != username">
            and a.username = #{username}
        </if>
        <if test="password != null and '' != password">
            and a.password = #{password}
        </if>
        <if test="realname != null and '' != realname">
            and a.realname = #{realname}
        </if>
        <if test="contact != null and '' != contact">
            and a.contact = #{contact}
        </if>
    </select>
    <!-- 按条件模糊查询 Mapper通过id调用此配置 -->
    <select id="getByLike" parameterType="thinginfo" resultMap="thinginfoMap">
        select a.* from thinginfo a where 1=1
        <if test="username != null and '' != username">
            and a.username like CONCAT('%', CONCAT(#{username}, '%'))
        </if>
        <if test="password != null and '' != password">
            and a.password like CONCAT('%', CONCAT(#{password}, '%'))
        </if>
        <if test="realname != null and '' != realname">
            and a.realname like CONCAT('%', CONCAT(#{realname}, '%'))
        </if>
        <if test="contact != null and '' != contact">
            and a.contact like CONCAT('%', CONCAT(#{contact}, '%'))
        </if>
    </select>

</mapper>